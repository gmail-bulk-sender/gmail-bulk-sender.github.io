<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Incident Report Formatter – officeworkhelp.in</title>

  <!-- HTML2PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">

  <script>
  tailwind.config = {
    theme: {
      extend: {
        fontFamily: { sans: ['Inter', 'sans-serif'] },
        colors: { 'bubble-teal': '#3ef0e8' }
      }
    }
  }
  </script>

  <style>
    body { background:#020617; color:#e2e8f0; font-family:'Inter',sans-serif; }
    .bubble{position:absolute;border-radius:50%;opacity:.55;filter:blur(4px);animation:floatUp 18s infinite ease-in;}
    @keyframes floatUp{0%{transform:translateY(0) scale(1);opacity:.3;}50%{opacity:.65;}100%{transform:translateY(-150vh) scale(1.4);opacity:0;}}
    .nav-link:hover{color:#3ef0e8;}
    .dropdown{position:relative;}
    .dropdown-menu{position:absolute;top:2.6rem;right:0;background:#0f172a;border:1px solid #334155;border-radius:.5rem;
      padding:.5rem 0;width:220px;opacity:0;transform:translateY(-8px);pointer-events:none;transition:.25s;z-index:50;}
    .dropdown-item{padding:.6rem 1rem;font-size:.9rem;color:#94a3b8;}
    .dropdown-item:hover{background:#1e293b;color:#3ef0e8;}
    .dropdown-menu.show{opacity:1;transform:translateY(0);pointer-events:auto;}
  </style>
</head>

<body>

<!-- Bubbles -->
<div id="bubble-container" class="fixed inset-0 -z-10 overflow-hidden pointer-events-none"></div>

<!-- NAV -->
<header class="sticky top-0 bg-gray-900/60 backdrop-blur-md border-b border-gray-700 z-40">
  <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
    <a href="index.html" class="text-2xl font-black text-bubble-teal">officeworkhelp.in</a>

    <nav class="flex gap-8 text-gray-300">
      <a href="index.html" class="nav-link">Home</a>

      <div class="dropdown">
        <button id="toolsBtn" class="nav-link flex items-center gap-1">Tools
          <svg width="14" height="14" stroke="currentColor" viewBox="0 0 24 24">
            <polyline points="6 9 12 15 18 9" fill="none" stroke-width="2"
              stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>
        <div id="toolsDropdown" class="dropdown-menu">
          <a class="dropdown-item" href="bulk-email.html">Bulk Email Sender</a>
          <a class="dropdown-item" href="incident-report.html">Incident Report Formatter</a>
          <a class="dropdown-item" href="admin.html">Admin Dashboard</a>
          <a class="dropdown-item" href="tools.html">All Tools</a>
        </div>
      </div>

      <a href="about.html" class="nav-link">About Me</a>
    </nav>
  </div>
</header>

<!-- MAIN -->
<main class="max-w-7xl mx-auto px-6 py-10">

  <h2 class="text-4xl font-extrabold text-bubble-teal mb-3">Incident Report Formatter</h2>
  <p class="text-gray-400 mb-10">Transform raw incident details into a polished professional report.</p>

  <div class="grid lg:grid-cols-2 gap-10">

    <!-- FORM INPUTS -->
    <div class="space-y-6">

      <div>
        <label class="font-semibold">Incident Summary:</label>
        <input id="ir-summary" type="text" class="w-full mt-1 px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg"
               placeholder="e.g. Theft of mobile phone at office" oninput="irUpdatePreview()" />
      </div>

      <div>
        <label class="font-semibold">Date & Time:</label>
        <input id="ir-datetime" type="text" class="w-full mt-1 px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg"
               placeholder="e.g. 05 Dec 2025, 3:45 PM" oninput="irUpdatePreview()" />
      </div>

      <div>
        <label class="font-semibold">Location:</label>
        <input id="ir-location" type="text" class="w-full mt-1 px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg"
               placeholder="e.g. Mumbai Office – 3rd Floor" oninput="irUpdatePreview()" />
      </div>

      <div>
        <label class="font-semibold">Persons Involved:</label>
        <textarea id="ir-persons" rows="3"
                  class="w-full mt-1 px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg"
                  placeholder="e.g. Mr. X (victim), Mr. Y (witness)"
                  oninput="irUpdatePreview()"></textarea>
      </div>

      <div>
        <label class="font-semibold">Incident Description:</label>
        <textarea id="ir-description" rows="6"
                  class="w-full mt-1 px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg"
                  placeholder="Write the description in simple words…"
                  oninput="irUpdatePreview()"></textarea>
      </div>

      <div>
        <label class="font-semibold">Actions Taken:</label>
        <textarea id="ir-actions" rows="4"
                  class="w-full mt-1 px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg"
                  placeholder="Steps taken after the incident…"
                  oninput="irUpdatePreview()"></textarea>
      </div>

      <div>
        <label class="font-semibold">Damage / Loss (if any):</label>
        <textarea id="ir-damage" rows="3"
                  class="w-full mt-1 px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg"
                  placeholder="Property, equipment, injury etc."
                  oninput="irUpdatePreview()"></textarea>
      </div>

      <div>
        <label class="font-semibold">Witness Statement:</label>
        <textarea id="ir-witness" rows="3"
                  class="w-full mt-1 px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg"
                  placeholder="Statements from witnesses…"
                  oninput="irUpdatePreview()"></textarea>
      </div>

      <div>
        <label class="font-semibold">Reporting Officer:</label>
        <input id="ir-officer" type="text"
               class="w-full mt-1 px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg"
               placeholder="Your name & designation" oninput="irUpdatePreview()" />
      </div>

      <!-- EXPORT BUTTONS -->
      <div class="pt-4 flex gap-4">
        <button onclick="irExportPDF()"
                class="px-5 py-2 bg-bubble-teal text-black rounded-xl font-semibold hover:bg-bubble-teal/90">
          Export PDF
        </button>

        <button onclick="irExportWord()"
                class="px-5 py-2 border border-bubble-teal text-bubble-teal rounded-xl hover:bg-bubble-teal hover:text-black">
          Export Word
        </button>
      </div>

    </div>

    <!-- PREVIEW -->
    <div>
      <h3 class="text-xl font-bold text-bubble-teal mb-3">Live Preview:</h3>
      <div id="ir-preview"
           class="bg-white text-black p-6 rounded-xl shadow-lg min-h-[400px] text-sm leading-relaxed"></div>
    </div>

  </div>

</main>

<footer class="mt-12 border-t border-gray-800 py-4 text-center text-xs text-gray-500">
  © 2025 officeworkhelp.in · Helping hard work meet smart work.
</footer>

<script>
/* --- FLOATING BUBBLES --- */
function spawnBubbles() {
  const container = document.getElementById("bubble-container");
  const count = 14;

  for (let i = 0; i < count; i++) {
    const b = document.createElement("div");
    b.className = "bubble";
    const size = 80 + Math.random() * 180;
    b.style.width = size + "px";
    b.style.height = size + "px";
    b.style.left = Math.random() * 100 + "vw";
    b.style.bottom = "-260px";
    b.style.animationDuration = (16 + Math.random() * 12) + "s";
    b.style.animationDelay = Math.random() * 15 + "s";
    b.style.background =
      `radial-gradient(circle at 30% 25%, rgba(255,255,255,0.7),
         hsla(${170 + Math.random()*40},80%,30%,0.1))`;
    container.appendChild(b);
  }
}

/* --- DROPDOWN NAV --- */
function setupDropdown() {
  const btn = document.getElementById("toolsBtn");
  const menu = document.getElementById("toolsDropdown");
  if (!btn || !menu) return;

  btn.addEventListener("click", e => {
    e.stopPropagation();
    menu.classList.toggle("show");
  });

  document.addEventListener("click", e => {
    if (!menu.contains(e.target) && !btn.contains(e.target)) {
      menu.classList.remove("show");
    }
  });
}

/* --- TEXT FORMALIZER --- */
function irFormalizeText(t) {
  if (!t) return "";
  return t
    .trim()
    .replace(/\s+/g, " ")
    .replace(/\bi\b/g, "I")
    .replace(/^./, c => c.toUpperCase());
}

/* --- UPDATE PREVIEW --- */
function irUpdatePreview() {
  const summary = irFormalizeText(document.getElementById("ir-summary").value);
  const dt = irFormalizeText(document.getElementById("ir-datetime").value);
  const loc = irFormalizeText(document.getElementById("ir-location").value);
  const persons = irFormalizeText(document.getElementById("ir-persons").value);
  const desc = irFormalizeText(document.getElementById("ir-description").value);
  const act = irFormalizeText(document.getElementById("ir-actions").value);
  const dmg = irFormalizeText(document.getElementById("ir-damage").value);
  const wit = irFormalizeText(document.getElementById("ir-witness").value);
  const off = irFormalizeText(document.getElementById("ir-officer").value);

  const preview = document.getElementById("ir-preview");

  preview.innerHTML = `
    <h2 style="font-size:20px;font-weight:700;margin-bottom:10px;">
      INCIDENT REPORT
    </h2>

    <p><strong>Summary:</strong> ${summary || "—"}</p>
    <p><strong>Date & Time:</strong> ${dt || "—"}</p>
    <p><strong>Location:</strong> ${loc || "—"}</p>
    <p><strong>Persons Involved:</strong> ${persons || "—"}</p>

    <h3 style="margin-top:12px;font-weight:700;">Description of Incident:</h3>
    <p>${desc || "—"}</p>

    <h3 style="margin-top:12px;font-weight:700;">Actions Taken:</h3>
    <p>${act || "—"}</p>

    <h3 style="margin-top:12px;font-weight:700;">Damage / Loss:</h3>
    <p>${dmg || "—"}</p>

    <h3 style="margin-top:12px;font-weight:700;">Witness Statement:</h3>
    <p>${wit || "—"}</p>

    <p style="margin-top:12px;"><strong>Reporting Officer:</strong> ${off || "—"}</p>

    <div style="font-size:10px;color:#666;text-align:right;margin-top:20px;opacity:.7;">
      Verified Report • officeworkhelp.in
    </div>
  `;
}

/* --- EXPORT PDF --- */
function irExportPDF() {
  const preview = document.getElementById("ir-preview");
  const opt = {
    margin: 0.5,
    filename: "Incident_Report.pdf",
    image: { type: "jpeg", quality: 0.98 },
    html2canvas: { scale: 2 },
    jsPDF: { unit: "in", format: "letter", orientation: "portrait" }
  };
  html2pdf().from(preview).set(opt).save();
}

/* --- EXPORT WORD --- */
function irExportWord() {
  const content = document.getElementById("ir-preview").innerHTML;
  const blob = new Blob(
    [`<html><body>${content}</body></html>`],
    { type: "application/msword" }
  );
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url;
  a.download = "Incident_Report.doc";
  a.click();
  URL.revokeObjectURL(url);
}

document.addEventListener("DOMContentLoaded", () => {
  spawnBubbles();
  setupDropdown();
  irUpdatePreview();
});
</script>
<script src="/assets/bubbles.js"></script>
</body>
</html>
